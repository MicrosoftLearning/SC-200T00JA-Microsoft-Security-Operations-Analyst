# モジュール 7 - ラボ 1 - 演習 8 - ワークブックの作成

## ラボ シナリオ

あなたは Azure Sentinel を実装済みの会社で働いているセキュリティ オペレーションアナリストです。高度な視覚化を使用してワークブックを設計する必要があります。

### タスク 1: ワークブックを調べる

このタスクでは、ブックの構成について説明します。

1. 管理者として WIN1 仮想マシンにログインします。パスワードは **Pa55w.rd** です。  

2. Edge ブラウザーで Azure ポータルに移動します https://portal.azure.com

3. **サインイン**ダイアログボックスで、ラボ ホスティング プロバイダーから提供された**テナントの電子メール** アカウントをコピーして貼り付け、「**次へ**」を選択します。

4. **パスワードの入力**ダイアログ ボックスで、ラボ ホスティング プロバイダーから提供された**テナントパスワード** をコピーして貼り付け、「**サインイン**」を選択します。

5. Azure ポータルの検索バーに 「*Sentinel*」 と入力し、「**Azure Sentinel**」を選択します。

6. Azure Sentinel ワークスペースを選択します。

7. 「**ブック**」を選択します。

8. 「**ID およびアクセス**」を検索してクリックし、右下の「**テンプレートの表示**」ボタンを選択します。

9. 「ID およびアクセス」ワークブックを確認します。

10. **Azure Sentinel | ブック** 域に戻り (左にスクロールします) で、「**テンプレート**」タブを選択します。

11. テンプレート タブで 「**Azure AD サインイン ログ**」を検索して選択し、右下の「**保存**」を選択します。 

12. 適切なリージョンを選択します。  適切な場所は通常、既定です。

13. 「**マイ ブック**」タブを選択します。

1. 左下の「**保存されたブックの表示**」をクリックします。

14. 左上のコマンドバーの「**編集**」を選択します。

15. 「*Sign-ins by Location*」領域で、グリッドの右下にある「**編集**」を選択します。

#### 列をフォーマットするには、列設定パネルにカスタマイズオプションがあるので、次のようにします。

16. クエリコマンドバーの右にある「**列の設定**」を選択します。

17. 「*列の設定の編集*」で、「**Failure Count|Interrupt Count**」列を選択します。

18. 列のレンダラーやカラーパレットなどの設定を確認します。

19. 列 「**Trend**」 を選択します。

20. 列のレンダラーやカラーパレットなどの設定を確認します。

21. [**キャンセル**」を選択します。

#### タイル/グリッドのコントロールが、別のタイル/グリッドの結果をフィルタリングするには、次のようにします。

22. クエリの「**詳細設定**」タブを選択します。

23. 「*項目が選択されている場合、パラメーターをエクスポートする*」設定を確認します。  *LocationDetail* フィールドが選択されていることに注意してください。

24. クエリの下部にある「**編集が完了しました**」を選択します。

25. 画面の右側にある **Device Sign-in details**テーブルの「**編集**」を選択します。  

26. クエリの中で「**詳細設定」** をクリックします。  このクエリは、他のクエリからエクスポートされたパラメータを使用して結果をフィルタリングしています。

27. クエリの「**編集が完了しました**」を選択します。

28. ワークブックの**編集完了**を選択します。

### タスク 2: ワークブックを作成します。

このタスクでは、高度な視覚化を備えた新しいワークブックを作成します。

1. Azure Sentinel ポータルで「**ブック**」を選択します。

2. 「**+ ブックの追加**」をクリックします

3. 「**編集**]を選択します

#### ヘッダーテキストを編集します:

4. 右側には２つの「**編集**」ボタンがあります。上の「**編集**」をクリックし、**New workbook** を **My workbook** に変更します。

5. 下にある「**編集が完了しました**」を選択します。

6. 表示されているグラフの下にある「**編集**」を選択します。

7. 複数のテーブルにわたるカウントの和集合を提供する KQL ステートメントを確認してください。

8. グラフの下にある「**編集を完了しました**」を選択します。

9. グラフ領域の右横の 「...」 を選択し、「**+ 追加**」を選択し、「**クエリを追加**」を選択します。

10. クエリ ボックスに「*SecurityEvent*」と入力し、「**クエリの実行**」ボタンを選択します。

11. 時間の範囲を「**過去 3 日**」に変更します。

12. 視覚化をさまざまなオプションに変更して、結果を確認します。

13. 視覚化を「**時間グラフ**」に変更します。

14. クエリタブの「**スタイル**」を選択します。

15. 「**この項目をユーザー設定の幅にします**」 ボックスを選択します。

16. パーセント幅 を 「**75**」 に、最大幅 を 「**75**」 に設定します。

17. クエリタブの「**詳細設定**」を選択します。

18. 「**編集中でないときに更新アイコンを表示する**」ボックスを選択します。 

19. 「**編集が完了しました**」を選択します。

20. 「**追加**」、「**クエリの追加**」 の順に選択します。

クエリに対して次の KQLコマンドを入力します。

```
SecurityEvent
```

21. 「時間の範囲」で、「**過去 4 時間**」を選択します。

22. 視覚化を「**グリッド**」に変更します。

23. 「**スタイル**」 タブを選択します。

24. 「**この項目をユーザー設定の幅にします**」を選択します。

25. パーセント幅を「**25**」、最大幅を「**25**」に変更します。 

26. クエリの「**編集が完了しました**」を選択します。

27. ワークブックの「**編集が完了しました**」を選択します。

28. 「**保存**（フロッピーアイコン）」を選択し、プロンプトが表示されたら再度「**保存**」を選択します。

29. AzureSentinelポータルの「**ブック**」に戻ります。

30. 「**マイ ブック**」タブを選択し、最新の情報に更新ボタンをクリックします。

31. 作成したワークブックを選択します。

32. 「**保存されたワークブックの表示**」を選択します。

## これでラボは完了です。
