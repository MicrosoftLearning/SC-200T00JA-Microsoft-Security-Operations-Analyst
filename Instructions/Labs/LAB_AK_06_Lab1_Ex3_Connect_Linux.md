# モジュール 6 - ラボ 1 - 演習 3 - データコネクタを使用して Linux ホストを Azure Sentinel に接続する

### タスク 1: Azure Sentinel ワークスペースにアクセスします。

このタスクでは、Azure Sentinel ワークスペースにアクセスします。

1. 管理者として WIN1 仮想マシンにログインします。パスワードは **Pa55w.rd** です。  

3. Edge ブラウザーで Azure ポータルに移動します https://portal.azure.com

4. **サインイン**ダイアログボックスで、ラボ ホスティング プロバイダーから提供された**テナントの電子メール**アカウントをコピーして貼り付け、「**次へ**」を選択します。

5. **パスワードの入力**ダイアログ ボックスで、ラボ ホスティング プロバイダーから提供された**テナントパスワード** をコピーして貼り付け、「**サインイン**」を選択します。

6. Azure ポータルの検索バーに 「*Sentinel*」 と入力し、「**Azure Sentinel**」 を選択します。

7. 前のラボで作成した Azure Sentinel ワークスペースを選択します。

### タスク 2: Common Event Format のコネクタを使用してLinuxホストを接続します。

このタスクでは、Linux ホストを Common Event Format （CEF） コネクタを使用して Azure Sentinel に接続します。

1. Azure Sentinel の構成領域から「**データコネクタ**」を選択します。  データ コネクタ タブで、リストから**Common Event Format**コネクタを選択します。

2. コネクタ情報ブレードで「**コネクタページを開く**」を選択します。

3. 1.2 に書かれているコマンドは、あとで、LINに CFEコレクターをインストールするために使用します。

4. LIN1 マシンに切り替えます。

5. root / Passw0rd! で LIN1 にログインします。

6. ログイン時に表示されるメッセージの中間あたりに書かれている、IP Address を確認します。

7. Win1 に戻り、PowerShell を起動します。

8. ssh <insert your linux IP address here> -l root  で、LIN1 に接続します。

9. ブラウザに表示されている CEF コレクターをインストールするためのコマンドをメモ帳等に貼り付けます。

10. **Sudo python cef_installer.py** と書かれている部分を **Sudo python3 cef_installer.py** に修正します。
 
11. コマンドをコピーし、ssh のプロンプトに貼り付けて実行します。

12. インストールが完了すると、**Install completed** と表示されます。インストールは30秒程度で終わります。
  
### タスク 3: Syslog コネクタを使用して Linux ホストを接続します。

このタスクでは、LIN2 Linux ホストを Syslog コネクタを使用して Azure Sentinel に接続します。

1. WIN1 で Azure Sentinel ポータルを開き、Sentinel に移動します。  

2. データ コネクタ タブで、リストから **Syslog** コネクタを選択します。

3. コネクタ情報ブレードで「**コネクタページを開く**」を選択します。

4. **Install agent on a non-Azure Linux Machine** セクションを開きます。

5. **Azure 以外の Linux マシンのエージェントをダウンロードしてインストールする** をクリックします。 

6. 「**Linux サーバー**」のタブを選択します。

7. **Linux 用エージェントをダウンロードおよびオンボードする** に表示されているコマンドをコピーします。

8. LIN2 に切り替えます。

9. LIN2 にログインします。

10. ログオン時に表示されるメッセージで、LIN2 の IP アドレスを確認します。

11. Win1 に戻り、PowerShell を起動します。

12. ssh <insert your linux IP address here> -l root  で、LIN2 に接続します。

13. 先ほどのコマンドをコピーして、プロンプトに貼り付け、実行します。

14. インストールが完了すると、**Shell bundle exiting with code 0** が表示されます。
  
### タスク 4: 収集するファシリティとその重大度を Syslog コネクタ用に設定します。

このタスクでは、Syslog 収集機能を構成します。

1. WIN1 仮想マシンに接続します。

2. Azure Sentinel ポータルで、設定ブレードから「**設定**」、「**ワークスペース設定**」の順に選択します。

3. **設定** 領域で「**エージェント構成**」を選択します。

4. 「**Syslog**」 タブを選択します。

5. 「**ファシリティの追加**」ボタンを選択します。

6. 「**auth**」 を選択します。

7. 「**ファシリティの追加**」ボタンを選択します。

8. 「*authpriv*」 を選択します。

9. 「**適用**」をクリックします。

## 演習 4 に進みます。
