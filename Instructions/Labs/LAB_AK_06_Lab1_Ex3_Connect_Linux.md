# モジュール 6 - ラボ 1 - 演習 3 - データコネクタを使用して Linux ホストを Azure Sentinel に接続する

### タスク 1: Azure Sentinel ワークスペースにアクセスします。

このタスクでは、Azure Sentinel ワークスペースにアクセスします。

1. 管理者として WIN1 仮想マシンにログインします。パスワードは **Pa55w.rd** です。  

2. 新しい Microsoft Edge ブラウザーを起動します。

3. Edge ブラウザーで Azure ポータルに移動します https://portal.azure.com

4. **サインイン** ダイアログ ボックスで、ラボ ホスティング プロバイダーから提供された**テナントの電子メール**アカウントをコピーして貼り付け、「**次へ**」を選択します。

5. **パスワードの入力**ダイアログ ボックスで、ラボ ホスティング プロバイダーから提供された**テナントパスワード** をコピーして貼り付け、「**サインイン**」を選択します。

6. Azure ポータルの検索バーに 「*Sentinel*」 と入力し、「**Azure Sentinel**」 を選択します。

7. 前のラボで作成した Azure Sentinel ワークスペースを選択します。

### タスク 2: Common Event Format のコネクタを使用してLinuxホストを接続します。

このタスクでは、Linux ホストを Common Event Format （CEF） コネクタを使用して Azure Sentinel に接続します。

1. AzureSentinelの構成領域から「**データコネクタ**」を選択します。  データ コネクタ タブで、リストから**共通イベント形式 (CEF)** コネクタを選択します。

2. コネクタ情報ブレードで「**コネクタページを開く**」を選択します。

3. 「*1.2 Linux マシンへの CEF コレクターのインストール*」に示されているコマンドをクリップボードにコピーします。

4. LIN1 仮想マシンを起動し、ラボのホスティング業者から提供されたユーザー名とパスワードを使用してログインします。LIN1 サーバー IP アドレスを書き留めます。例として次のスクリーンショットをご覧ください。

   ![Linux ログイン](../Media/LinuxLoginExample.png)

5. WIN1 仮想マシンに戻り、管理者として Windows PowerShell を起動します。

6. 次の PowerShell コマンドを入力し、特定の Linux サーバー情報に合わせて調整し、Enter キーを押します。

```PowerShell
ssh <insert your linux IP address here> -l <insert linux user name here>
```

7. PowerShell でユーザーのパスワードの入力を求められたら、パスワードを入力して Enter キーを押します。  画面は次のようになります。

   ![Linux ログイン](../Media/PSconnectLinux.png)

8. これで、前の手順の「*1.2 Linux マシンへの CEF コレクターのインストール*」に貼り付ける準備ができました。Azure のスクリプトがクリップボードにあることを確認してください。PowerShell で、トップ バーを右クリックし、「**編集**」、「**貼り付け**」の順に選択します。貼り付けたら、次に示すように *python* という単語に **3** を追加します。

   ![ConnectorScript](../Media/ConnectorScript.png)


9. スクリプトを貼り付けて調整したら、Enter キーを押します。スクリプトは Linux サーバーに対してリモートで実行されます。スクリプトが適切に処理されると、次の画面のようになります。

   ![ConnectorScript](../Media/LinuxConnected.png)

### タスク 3: Syslog コネクタを使用して Linux ホストを接続します。

このタスクでは、Linux ホストを　Syslog　コネクタを使用して　Azure　Sentinel　に接続します。

1. WIN1 に接続します。WIN1 は、ワークスペースの Azure Sentinel ポータルに既に存在しているはずです。  

2. データ コネクタ タブで、リストから **Syslog** コネクタを選択します。

3. コネクタ情報ブレードで「**コネクタページを開く**」を選択します。

4. **非 Azure Linux マシンにエージェントをインストール**セクションを開きます。

5. **Azure 以外の Linux マシンのエージェントをダウンロードしてインストールする** をクリックします。 

6. 「**Linux サーバー**」のタブを選択します。

7. *Linux 用のダウンロードおよびオンボード エージェント*領域のコマンドをクリップボードにコピーします。

8. LIN2 仮想マシンを起動し、ラボのホスティング業者から提供されたユーザー名とパスワードを使用してログインします。LIN2 サーバー IP アドレスを書き留めます。例として次のスクリーンショットをご覧ください。

   ![Linux ログイン](../Media/LinuxLoginExample.png)

9. WIN1 仮想マシンに戻り、管理者として Windows PowerShell を起動します。

10. 次の PowerShell コマンドを入力し、特定の Linux サーバー情報に合わせて調整し、Enter キーを押します。

```PowerShell
ssh <insert your linux IP address here> -l <insert linux user name here>
```

11. PowerShell でユーザーのパスワードの入力を求められたら、パスワードを入力して Enter キーを押します。  画面は次のようになります。

   ![Linux ログイン](../Media/PSconnectLinux.png)

12. これで、前の手順の「*Linux 用のダウンロードおよびオンボード エージェント*」に貼り付ける準備ができました。Azure のスクリプトがクリップボードにあることを確認してください。PowerShell で、トップ バーを右クリックし、「**編集**」、「**貼り付け**」の順に選択します。

13. スクリプトが貼り付けられたら、Enter キーを押します。スクリプトは Linux サーバーに対してリモートで実行されます。タスクが完了しました。このコースのこれ以上のラボは、この接続に依存していません。

### タスク 4: 収集するファシリティとその重大度を Syslog コネクタ用に設定します。

このタスクでは、Syslog 収集機能を構成します。

1. WIN1 仮想マシンに接続します。

2. Azure Sentinel ポータルで、設定ブレードから「**設定**」、「**ワークスペース設定**」の順に選択します。

3. 「**設定**」領域で「**エージェントの構成**」を選択します。

4. 「**Syslog**」 タブを選択します。

5. 「**+ 設備の追加**」ボタンを選択します。

6. 「*施設名*」ドロップダウン メニューから「**認証**」を選択します。

7. 「**設備の追加**」ボタンを選択します。

8. 「*施設名*」ドロップダウン メニューから「*authpriv*」を入力します。

9. 「**適用**」を選択します。  このタスクが完了しました。

## 演習 4 に進みます。
